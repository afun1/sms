<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sparky Messaging</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            padding-top: 80px;
        }

        /* MAIN CONTENT */
        .main-content {
            padding: 30px 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .dashboard-header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .dashboard-header p {
            font-size: 1.3em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 1.1em;
            font-weight: 500;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .tool-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .tool-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .tool-card.ai {
            border-color: #667eea;
        }

        .tool-card.sms {
            border-color: #ff6b6b;
        }

        .tool-card.email {
            border-color: #2ecc71;
        }

        .tool-card.rvm {
            border-color: #9b59b6;
        }

        .tool-card.campaign {
            border-color: #f39c12;
        }

        .tool-card.assets {
            border-color: #ff9f43;
        }

        .tool-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .tool-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .tool-description {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .tool-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .tool-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .recent-activity {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 40px auto;
            max-width: 1200px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .activity-header {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .activity-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }

        .activity-icon.success {
            background: #d4edda;
            color: #155724;
        }

        .activity-icon.pending {
            background: #fff3cd;
            color: #856404;
        }

        .activity-icon.info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .activity-details {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            color: #333;
        }

        .activity-time {
            color: #666;
            font-size: 0.9em;
        }

        /* Asset Integration Styles */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* MOBILE RESPONSIVE */
        @media (max-width: 768px) {
            .dashboard-header h1 {
                font-size: 2.5em;
            }

            .tools-grid {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 0 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation will be injected by global-nav.js -->

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <h1>üìä Dashboard</h1>
            <p>Welcome to your Sparky Messaging command center</p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üì±</div>
                <div class="stat-number" id="smsCount">1,247</div>
                <div class="stat-label">SMS Sent</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìß</div>
                <div class="stat-number" id="emailCount">892</div>
                <div class="stat-label">Emails Sent</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üéôÔ∏è</div>
                <div class="stat-number" id="rvmCount">456</div>
                <div class="stat-label">RVMs Delivered</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÅ</div>
                <div class="stat-number" id="assetCount">0</div>
                <div class="stat-label">Assets Stored</div>
            </div>
        </div>

        <!-- Tools Grid -->
        <div class="tools-grid">
            <!-- AI Content Generator -->
            <div class="tool-card ai">
                <div class="tool-icon">ü§ñ</div>
                <div class="tool-title">AI Content Generator</div>
                <div class="tool-description">
                    Create powerful marketing content with AI assistance. Generate SMS, email, and RVM scripts automatically.
                </div>
                <a href="ai_editor.html" class="tool-button">Launch AI Editor</a>
            </div>

            <!-- SMS Editor -->
            <div class="tool-card sms">
                <div class="tool-icon">üì±</div>
                <div class="tool-title">SMS Editor</div>
                <div class="tool-description">
                    Create and send SMS messages with delivery tracking and analytics.
                </div>
                <a href="sms_editor.html" class="tool-button">Create SMS</a>
            </div>

            <!-- Email Editor -->
            <div class="tool-card email">
                <div class="tool-icon">üìß</div>
                <div class="tool-title">Email Editor</div>
                <div class="tool-description">
                    Design professional email campaigns with live preview and multi-provider optimization.
                </div>
                <a href="email_editor.html" class="tool-button">Create Email</a>
            </div>

            <!-- RVM Editor -->
            <div class="tool-card rvm">
                <div class="tool-icon">üéôÔ∏è</div>
                <div class="tool-title">RVM Editor</div>
                <div class="tool-description">
                    Create ringless voicemail scripts with text-to-speech preview and optimization.
                </div>
                <a href="rvm_editor.html" class="tool-button">Create RVM</a>
            </div>

            <!-- Campaign Builder -->
            <div class="tool-card campaign">
                <div class="tool-icon">üöÄ</div>
                <div class="tool-title">Campaign Builder</div>
                <div class="tool-description">
                    Build multi-channel campaigns with advanced targeting and optimization.
                </div>
                <a href="campaign_builder.html" class="tool-button">Build Campaign</a>
            </div>

            <!-- Assets Manager -->
            <div class="tool-card assets">
                <div class="tool-icon">üìÅ</div>
                <div class="tool-title">Assets Manager</div>
                <div class="tool-description">
                    Upload, manage, and share images, videos, and documents across all your campaigns.
                </div>
                <a href="assets/supabase-assets.html" class="tool-button">Manage Assets</a>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity">
            <div class="activity-header">
                üìà Recent Activity
            </div>
            <div class="activity-item">
                <div class="activity-icon success">‚úÖ</div>
                <div class="activity-details">
                    <div class="activity-title">SMS Campaign "Summer Sale" completed</div>
                    <div class="activity-time">2 hours ago ‚Ä¢ 1,200 messages sent</div>
                </div>
            </div>
            <div class="activity-item">
                <div class="activity-icon pending">‚è≥</div>
                <div class="activity-details">
                    <div class="activity-title">Email Campaign "Newsletter #45" in progress</div>
                    <div class="activity-time">1 hour ago ‚Ä¢ 67% delivered</div>
                </div>
            </div>
            <div class="activity-item">
                <div class="activity-icon info">üìÅ</div>
                <div class="activity-details">
                    <div class="activity-title">New assets uploaded to cloud storage</div>
                    <div class="activity-time">3 hours ago ‚Ä¢ <span id="recentAssetsCount">0</span> files added</div>
                </div>
            </div>
            <div class="activity-item">
                <div class="activity-icon success">‚úÖ</div>
                <div class="activity-details">
                    <div class="activity-title">RVM Campaign "Follow-up Calls" completed</div>
                    <div class="activity-time">4 hours ago ‚Ä¢ 450 voicemails delivered</div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Supabase configuration
        const supabaseUrl = 'https://bapvkcqoywysuosuodrb.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhcHZrY3FveXd5c3Vvc3VvZHJiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzNjMxNTMsImV4cCI6MjA2NTkzOTE1M30.XOIX4QvMl86i_sO3Q5IGMwAJp9UK86Q-ajeILsbvt_E';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

        // Initialize dashboard
        function initializeDashboard() {
            // No navWelcome or adminLink logic needed; handled by global-nav.js

            // Load user stats (simulate API call)
            loadUserStats();
            
            // Load asset count
            loadAssetCount();
        }

        function loadUserStats() {
            // Simulate loading stats from API
            const stats = {
                sms: Math.floor(Math.random() * 2000) + 1000,
                email: Math.floor(Math.random() * 1500) + 500,
                rvm: Math.floor(Math.random() * 800) + 200
            };

            // Update display with animation
            animateCounter('smsCount', stats.sms);
            animateCounter('emailCount', stats.email);
            animateCounter('rvmCount', stats.rvm);
        }

        async function loadAssetCount() {
            try {
                const { data, error } = await supabase.storage
                    .from('sparky-assets')
                    .list('', { limit: 1000 });

                if (error) {
                    console.error('Error loading asset count:', error);
                    return;
                }

                const assetCount = data ? data.length : 0;
                animateCounter('assetCount', assetCount);
                
                // Update recent activity with actual count
                const recentCount = Math.min(assetCount, Math.floor(Math.random() * 5) + 1);
                document.getElementById('recentAssetsCount').textContent = recentCount;

            } catch (error) {
                console.error('Error connecting to Supabase:', error);
                document.getElementById('assetCount').textContent = '0';
            }
        }

        function animateCounter(elementId, target, suffix = '') {
            const element = document.getElementById(elementId);
            const duration = 1500;
            const start = 0;
            const increment = target / (duration / 16);
            let current = start;

            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = Math.floor(current).toLocaleString() + suffix;
            }, 16);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
    <script src="static/global-nav.js"></script>
</body>
</html>